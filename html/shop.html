<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="../css/style.css" rel="stylesheet" type="text/css">
  <meta name="author" content="Eik Ulfsson">
  <meta name="robots" content="noindex, nofollow">
</head>

<body class="mainpage">
  <div class="header">
    <h1>Museum of Odds 'n' Ends</h1>
    <button onclick="location.href='../index.html'" class="navigation">Home</button>
    <button onclick="location.href='../html/staff.html'" class="navigation">Staff</button>
    <button onclick="location.href='../html/collections.html'" class="navigation">Collections</button>
    <button onclick="location.href='../html/shop.html'" class="navigation">Shop</button>
    <button onclick="location.href='../html/cart.html'" class="navigation" id="viewCartBtn">View Cart</button>
  </div>
  <br>

  <div class="shop-container">

    <!-- BEGIN SINGLE ITEM BLOCK-->
    <div class="souvenir-item" data-id="item001">
      <img src="../images/collections/chamber-soup-bowl.jpg" alt="Metal Soup Bowl" onclick="openModal(this)" />
      <h3>Metal Soup Bowl</h3>
      <p>This fully functional soup bowl is a great gift for those who don't like to use a microwave. It is made from
        stainless steel and weathered to look like it came straight from the middle ages. Its large size can hold up to
        two liters of any soup and the stylish appearance will have guests talking.</p>
      <p><strong>Price:</strong> $39.99</p>
      <span class="qty-badge" aria-live="polite"></span>
      <button onclick="addToCart(this)" data-id="item001" data-name="Metal Soup Bowl"
        data-price="39.99" data-image="../images/collections/chamber-soup-bowl.jpg">Add Metal Soup Bowl to Cart</button>
    </div>
    <!-- END SINGLE ITEM BLOCK -->

    <!-- BEGIN SINGLE ITEM BLOCK-->
    <div class="souvenir-item" data-id="item002">
      <img src="../images/collections/drinking-horn.jpg" alt="Drinking Horn" onclick="openModal(this)" />
      <h3>Drinking Horn</h3>
      <p>Made from BPA-free materials, this drinking horn holds up to 1 liter of any drink of your choice. Microwaveable
        and dishwasher safe. Buy two and receive a free head strap so you can pretend to be a bull in a China shop!</p>
      <p><strong>Price:</strong> $29.99</p>
      <span class="qty-badge" aria-live="polite"></span>
      <button onclick="addToCart(this)" data-id="item002" data-name="Drinking Horn"
        data-price="29.99" data-image="../images/collections/drinking-horn.jpg">Add Drinking Horn to Cart</button>
    </div>
    <!-- END SINGLE ITEM BLOCK -->

    <!-- BEGIN SINGLE ITEM BLOCK-->
    <div class="souvenir-item" data-id="item003">
      <img src="../images/collections/stone-disc.jpg" alt="Stone Disc" onclick="openModal(this)" />
      <h3>Stone Disc</h3>
      <p>A real stone disc! Use it to grind your own flour or the bones of your enemies. Also useful as a doorstop,
        paperweight, trebuchet ammunition, garden decoration, spare tire, serving tray, or salad garnish.</p>
      <p><strong>Price:</strong> $69.99</p>
      <span class="qty-badge" aria-live="polite"></span>
      <button onclick="addToCart(this)" data-id="item003" data-name="Stone Disc"
        data-price="69.99" data-image="../images/collections/stone-disc.jpg">Add Stone Disc to Cart</button>
    </div>
    <!-- END SINGLE ITEM BLOCK -->

    <!-- BEGIN SINGLE ITEM BLOCK-->
    <div class="souvenir-item" data-id="item004">
      <img src="../images/collections/typewriter-gnmyost.jpg" alt="Typewriter" onclick="openModal(this)" />
      <h3>Typewriter</h3>
      <p>Back by popular demand, a working replica of the typewriter with just 7 letters and one punctuation mark! Type
        all of your favorite words: GM STONY, MSG TONY, or GYM SNOT. The possibilities are endless! Write the novel of
        your dreams and become a well-renouned author. Just think of us when you write your foreword!</p>
      <p><strong>Price:</strong> $129.99</p>
      <span class="qty-badge" aria-live="polite"></span>
      <button onclick="addToCart(this)" data-id="item004" data-name="Typewriter"
        data-price="129.99" data-image="../images/collections/typewriter-gnmyost.jpg">Add Typewriter to Cart</button>
    </div>
    <!-- END SINGLE ITEM BLOCK -->

  </div>

  <!-- MODAL -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <img id="modal-image" src="" alt="">
    </div>
  </div>

  <br>
  <div class="footer">
    This is a fictitious website created purely for academic purposes.<br>The contents of this site was conceived and
    created entirely by at least one human.<br>
    <hr>
    Background photo courtesy of Smithsonian Open Access.<br>
    Photgraphs from Pexels courtesy of: Katerina Holmes, Gustavo Fring, and Max Fischer.
  </div>

  <script>
    //this key links the shop to the cart

    const CART_KEY = 'museumCartV1';


    // This function reads the Cart information and write it to JSON  
    function readCart() {
      try { return JSON.parse(localStorage.getItem(CART_KEY)) || []; }
      catch { return []; }
    }

    function writeCart(cart) {
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }

    /*This function is called by the addToCart button the first part reads the dataset contined in the buttons and asssigns the values to variables */

    function addToCart(btn) {
      const id = btn.dataset.id;
      const name = btn.dataset.name;
      const unitPrice = Number(btn.dataset.price);
      const image = btn.dataset.image;


      /* This part puts all of the individual items and puts them into an object called cart and writes it to LocalStorage   */

      let cart = readCart();
      const idx = cart.findIndex(it => it.id === id);
      if (idx >= 0) {
        cart[idx].qty += 1;
      } else {
        cart.push({ id, name, unitPrice, qty: 1, image });
      }
      writeCart(cart);

      // Update the item card's qty badge

      const card = btn.closest('.souvenir-item');
      if (card) {
        const badge = card.querySelector('.qty-badge');
        if (badge) {
          const item = cart.find(it => it.id === id);
          badge.textContent = item ? `Qty: ${item.qty}` : '';
        }
      }
    }

    function openModal(imgElement) {
      const modal = document.getElementById("modal");
      const modalImage = document.getElementById("modal-image");
      modalImage.src = imgElement.src;
      modalImage.alt = imgElement.alt;
      modal.style.display = "block";
    }

    function closeModal() {
      document.getElementById("modal").style.display = "none";
    }

    // Optional: Close modal on outside click
    window.onclick = function (event) {
      const modal = document.getElementById("modal");
      if (event.target === modal) {
        closeModal();
      }
    }
  </script>
</body>

</html>